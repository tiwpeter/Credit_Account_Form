using System;
using System.Collections.Generic;
using System.Windows.Forms;
using FastReport;

namespace WindowsFormsApp2
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            OpenDesignerWithData(); // ✅ เรียกที่นี่
        }

        public void OpenDesignerWithData()
        {
            var customerList = new List<GetCustomersDTO>
            {
                new GetCustomersDTO
                {
                    CustomerId = 1,
                    GeneralName = "John Doe",
                    CustGroupCountry = new CustGroupCountryModel
                    {
                        CountryCode = "TH",
                        CountryName = "Thailand",
                        CountryDes = "Asia"
                    }
                }
            };

            Report report = new Report();
            report.RegisterData(customerList, "CustomerData");
            report.GetDataSource("CustomerData").Enabled = true;

            report.RegisterData(new List<CustGroupCountryModel> { customerList[0].CustGroupCountry }, "CustGroupCountry");
            report.GetDataSource("CustGroupCountry").Enabled = true;

            try
            {
                string path = System.IO.Path.Combine(Application.StartupPath, "CustomerReport.frx");
                report.Save(path);
                MessageBox.Show("Report saved at: " + path);
            }
            catch (Exception ex)
            {
                MessageBox.Show("Error: " + ex.Message);
            }
        }
    }
}
